import{C as I,D as A,G as g,H as a}from"./chunk-N64BN2RT.js";import{c as u}from"./chunk-SGXA3MTQ.js";import{J as s,M as m,P as c,Qa as x,Ra as W,Sa as M,_b as T,bc as f,cb as P,db as S,k as p,mb as D,n as C,nb as w,va as d,z as k}from"./chunk-RNAKR2YX.js";var F=class r{opacity=70;static \u0275fac=function(t){return new(t||r)};static \u0275cmp=d({type:r,selectors:[["app-loader"]],inputs:{opacity:"opacity"},decls:2,vars:2,consts:[[1,"loader-background","flex","h-full","w-full","items-center","justify-center"],["diameter","50","color","primary"]],template:function(t,o){t&1&&(x(0,"div",0),M(1,"mat-spinner",1),W()),t&2&&D("opacity",o.opacity/100)},dependencies:[T,A,I],styles:["[_nghost-%COMP%]{display:block}.loader-background[_ngcontent-%COMP%]{background-color:light-dark(rgba(255,255,255,.8),rgba(17,24,39,.8));backdrop-filter:blur(2px);-webkit-backdrop-filter:blur(2px);position:relative;z-index:1000}"]})};var h=class{cache=new Map;createCacheKey(e,t){let o=JSON.stringify(t,Object.keys(t).sort());return`${e}:${o}`}getCachedResponse(e,t){let o=this.createCacheKey(e,t);return this.cache.get(o)}fetchAndCache(e,t,o){let i=this.createCacheKey(e,t);return o().pipe(s(n=>this.cache.set(i,n)))}getWithCache(e,t,o){let i=this.getCachedResponse(e,t);return i?p(i).pipe(k(100)):this.fetchAndCache(e,t,o)}clearCache(e,t){if(e&&t!==void 0){let o=this.createCacheKey(e,t);this.cache.delete(o)}else e?Array.from(this.cache.keys()).filter(i=>i.startsWith(`${e}:`)).forEach(i=>this.cache.delete(i)):this.cache.clear()}};var O=class r extends h{constructor(t,o){super();this.http=t;this.notificationService=o}API_URL=u.apiUrl;getExerciseTypes(){return this.getWithCache("exercise-types",{},()=>this.http.get(`${this.API_URL}/exercise-types`).pipe(a({errorMessage:"Failed to load exercise types. Please try again.",notificationService:this.notificationService})))}static \u0275fac=function(o){return new(o||r)(c(f),c(g))};static \u0275prov=m({token:r,factory:r.\u0275fac,providedIn:"root"})};var _=class r{constructor(e,t){this.http=e;this.notificationService=t}API_URL=u.apiUrl;paginatedWorkoutsCache=new Map;getPaginatedWorkouts(e){return this.http.post(`${this.API_URL}/workouts/paginated`,e).pipe(s(t=>{let o=JSON.stringify(e);this.paginatedWorkoutsCache.set(o,t)}),a({errorMessage:"Failed to load workouts. Please try again.",notificationService:this.notificationService}))}createWorkout(e){return this.http.post(`${this.API_URL}/workouts`,e).pipe(s(()=>{this.clearPaginatedWorkoutsCache()}),a({successMessage:"Workout saved successfully!",errorMessage:"Failed to save workout. Please try again.",notificationService:this.notificationService}))}updateWorkout(e,t){return this.http.put(`${this.API_URL}/workouts/${e}`,t).pipe(s(()=>{this.clearPaginatedWorkoutsCache()}),a({successMessage:"Workout updated successfully!",errorMessage:"Failed to update workout. Please try again.",notificationService:this.notificationService}))}getTodaysWorkout(){return this.http.get(`${this.API_URL}/workouts/todays-workout`).pipe(a({errorMessage:"Failed to load today's workout. Please try again.",notificationService:this.notificationService}))}getWorkoutById(e){return this.http.get(`${this.API_URL}/workouts/${e}`).pipe(a({errorMessage:"Failed to load workout. Please try again.",notificationService:this.notificationService}))}readCachedLastMonthWorkouts(e){let t=e?new Date(e):new Date,o=new Date(t.getFullYear(),t.getMonth(),t.getDate()-1,23,59,59,999),i=new Date(o);if(i.setMonth(i.getMonth()-1),this.paginatedWorkoutsCache.size>0){let l=[];this.paginatedWorkoutsCache.forEach(v=>{l.push(...v.data)});let R=l.filter((v,j,N)=>j===N.findIndex(U=>U.id===v.id)),b=this.sortAndFilterWorkouts(R,i,o);if(b.length>2)return p(b)}let n={page:1,pageSize:31,fromDate:i.toISOString(),toDate:o.toISOString()};return this.getPaginatedWorkouts(n).pipe(C(l=>this.sortAndFilterWorkouts(l.data,i,o)))}sortAndFilterWorkouts(e,t,o){return e.filter(i=>{let n=new Date(i.dateCreated);return n>=t&&n<=o}).sort((i,n)=>new Date(n.dateCreated).getTime()-new Date(i.dateCreated).getTime())}clearPaginatedWorkoutsCache(){this.paginatedWorkoutsCache.clear()}static \u0275fac=function(t){return new(t||r)(c(f),c(g))};static \u0275prov=m({token:r,factory:r.\u0275fac,providedIn:"root"})};var $=["mat-internal-form-field",""],B=["*"],vt=(()=>{class r{labelPosition;static \u0275fac=function(o){return new(o||r)};static \u0275cmp=d({type:r,selectors:[["div","mat-internal-form-field",""]],hostAttrs:[1,"mdc-form-field","mat-internal-form-field"],hostVars:2,hostBindings:function(o,i){o&2&&w("mdc-form-field--align-end",i.labelPosition==="before")},inputs:{labelPosition:"labelPosition"},attrs:$,ngContentSelectors:B,decls:1,vars:0,template:function(o,i){o&1&&(P(),S(0))},styles:[`.mat-internal-form-field{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:inline-flex;align-items:center;vertical-align:middle}.mat-internal-form-field>label{margin-left:0;margin-right:auto;padding-left:4px;padding-right:0;order:0}[dir=rtl] .mat-internal-form-field>label{margin-left:auto;margin-right:0;padding-left:0;padding-right:4px}.mdc-form-field--align-end>label{margin-left:auto;margin-right:0;padding-left:0;padding-right:4px;order:-1}[dir=rtl] .mdc-form-field--align-end .mdc-form-field--align-end label{margin-left:0;margin-right:auto;padding-left:4px;padding-right:0}
`],encapsulation:2,changeDetection:0})}return r})();export{vt as a,F as b,h as c,O as d,_ as e};
